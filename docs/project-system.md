# é¡¹ç›®ç®¡ç†ç³»ç»Ÿ

> ä½œä¸ºåˆ›ä½œçš„é¡¶å±‚å®¹å™¨ï¼Œç»Ÿä¸€ç®¡ç†å°è¯´çš„æ‰€æœ‰å…ƒç´ 

---

## ğŸ“– ç³»ç»Ÿæ¦‚è¿°

é¡¹ç›®ç®¡ç†ç³»ç»Ÿæ˜¯çµç å°è¯´åŠ©æ‰‹çš„æ ¸å¿ƒæ¢çº½ï¼Œæ¯ä¸ªå°è¯´é¡¹ç›®ï¼ˆNovelProjectï¼‰æ˜¯æ‰€æœ‰åˆ›ä½œå†…å®¹çš„é¡¶å±‚å®¹å™¨ã€‚å®ƒç®¡ç†ç€å°è¯´çš„åŸºæœ¬ä¿¡æ¯ã€å…³è”çš„è§’è‰²ã€å¤§çº²ç»“æ„å’Œç« èŠ‚å†…å®¹ã€‚

---

## ğŸ¯ åŠŸèƒ½ç‰¹æ€§

### 1. é¡¹ç›®åˆ›å»ºä¸é…ç½®

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `title` | å­—ç¬¦ä¸² | å°è¯´æ ‡é¢˜ï¼ˆå¿…å¡«ï¼‰ |
| `description` | æ–‡æœ¬ | å°è¯´ç®€ä»‹ |
| `genre` | å­—ç¬¦ä¸² | å°è¯´ç±»å‹ï¼ˆç§‘å¹»ã€å¥‡å¹»ã€æ‚¬ç–‘ç­‰ï¼‰ |
| `style` | å­—ç¬¦ä¸² | å†™ä½œé£æ ¼ï¼ˆç°å®ä¸»ä¹‰ã€æµªæ¼«ä¸»ä¹‰ç­‰ï¼‰ |

### 2. é¡¹ç›®çŠ¶æ€ç®¡ç†

```
draft (è‰ç¨¿) â†’ in_progress (è¿›è¡Œä¸­) â†’ completed (å·²å®Œæˆ) â†’ archived (å·²å½’æ¡£)
```

| çŠ¶æ€ | è¯´æ˜ |
|------|------|
| `draft` | åˆå§‹çŠ¶æ€ï¼Œé¡¹ç›®åˆšåˆ›å»º |
| `in_progress` | æ­£åœ¨åˆ›ä½œä¸­ |
| `completed` | åˆ›ä½œå®Œæˆ |
| `archived` | å½’æ¡£å­˜å‚¨ |

### 3. ç« èŠ‚æ¨¡å¼åˆ‡æ¢

é¡¹ç›®æ”¯æŒä¸¤ç§åˆ›ä½œæ¨¡å¼ï¼š

| æ¨¡å¼ | å­—æ®µå€¼ | é€‚ç”¨åœºæ™¯ |
|------|--------|----------|
| **ç« èŠ‚æ¨¡å¼** | `use_chapter_system = true` | é•¿ç¯‡å°è¯´ï¼Œéœ€è¦ç« èŠ‚ç®¡ç† |
| **å•ç¯‡æ¨¡å¼** | `use_chapter_system = false` | çŸ­ç¯‡å°è¯´ï¼Œå†…å®¹å­˜å‚¨åœ¨ `content` å­—æ®µ |

### 4. å­—æ•°ç»Ÿè®¡

- **ç« èŠ‚æ¨¡å¼**: è‡ªåŠ¨æ±‡æ€»æ‰€æœ‰ç« èŠ‚çš„å­—æ•°
- **å•ç¯‡æ¨¡å¼**: å®æ—¶ç»Ÿè®¡ `content` å­—æ®µå­—æ•°

---

## ğŸ—„ï¸ æ•°æ®æ¨¡å‹

### NovelProject æ¨¡å‹

```python
class NovelProject(models.Model):
    id = fields.IntField(pk=True)
    title = fields.CharField(max_length=200)           # æ ‡é¢˜
    description = fields.TextField(null=True)          # ç®€ä»‹
    genre = fields.CharField(max_length=50, null=True) # ç±»å‹
    style = fields.CharField(max_length=50, null=True) # é£æ ¼
    status = fields.CharField(max_length=20, default="draft")  # çŠ¶æ€
    content = fields.TextField(null=True)              # å•ç¯‡æ¨¡å¼å†…å®¹
    word_count = fields.IntField(default=0)            # å­—æ•°
    use_chapter_system = fields.BooleanField(default=True)  # æ˜¯å¦ç« èŠ‚æ¨¡å¼
    chapter_ids = fields.JSONField(default=[])         # ç« èŠ‚IDåˆ—è¡¨
    user_id = fields.IntField()                        # åˆ›å»ºç”¨æˆ·
    created_at = fields.DatetimeField(auto_now_add=True)
    updated_at = fields.DatetimeField(auto_now=True)

    class Meta:
        table = "novel_projects"
```

### å…³è”å…³ç³»

```
NovelProject
    â”‚
    â”œâ”€â”€â†’ Character (characters)        # ä¸€å¯¹å¤šï¼šé¡¹ç›®è§’è‰²
    â”‚
    â”œâ”€â”€â†’ OutlineNode (outline_nodes)   # ä¸€å¯¹å¤šï¼šå¤§çº²èŠ‚ç‚¹
    â”‚
    â””â”€â”€â†’ Chapter (chapters)            # ä¸€å¯¹å¤šï¼šç« èŠ‚åˆ—è¡¨
```

---

## ğŸ”Œ API æ¥å£

### åŸºç¡€è·¯å¾„

```
/api/novel-project
```

### æ¥å£åˆ—è¡¨

| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| `GET` | `/` | è·å–å½“å‰ç”¨æˆ·çš„é¡¹ç›®åˆ—è¡¨ |
| `POST` | `/` | åˆ›å»ºæ–°é¡¹ç›® |
| `GET` | `/{project_id}` | è·å–é¡¹ç›®è¯¦æƒ… |
| `PUT` | `/{project_id}` | æ›´æ–°é¡¹ç›®ä¿¡æ¯ |
| `DELETE` | `/{project_id}` | åˆ é™¤é¡¹ç›® |
| `PUT` | `/{project_id}/status` | æ›´æ–°é¡¹ç›®çŠ¶æ€ |
| `GET` | `/{project_id}/statistics` | è·å–é¡¹ç›®ç»Ÿè®¡ä¿¡æ¯ |

### è¯·æ±‚/å“åº”ç¤ºä¾‹

#### åˆ›å»ºé¡¹ç›®

**è¯·æ±‚**:
```json
POST /api/novel-project
{
  "title": "æ˜Ÿé™…è¿·èˆª",
  "description": "ä¸€ä¸ªå…³äºå®‡å®™æ¢ç´¢çš„æ•…äº‹",
  "genre": "ç§‘å¹»",
  "style": "ç¡¬ç§‘å¹»",
  "use_chapter_system": true
}
```

**å“åº”**:
```json
{
  "id": 1,
  "title": "æ˜Ÿé™…è¿·èˆª",
  "description": "ä¸€ä¸ªå…³äºå®‡å®™æ¢ç´¢çš„æ•…äº‹",
  "genre": "ç§‘å¹»",
  "style": "ç¡¬ç§‘å¹»",
  "status": "draft",
  "use_chapter_system": true,
  "word_count": 0,
  "created_at": "2026-01-04T12:00:00Z"
}
```

#### è·å–é¡¹ç›®åˆ—è¡¨

**è¯·æ±‚**:
```
GET /api/novel-project?status=in_progress&page=1&page_size=10
```

**å“åº”**:
```json
{
  "items": [...],
  "total": 5,
  "page": 1,
  "page_size": 10
}
```

---

## ğŸ–¥ï¸ ç”¨æˆ·äº¤äº’

### é¡¹ç›®åˆ—è¡¨é¡µ

- **å¡ç‰‡è§†å›¾**: å±•ç¤ºé¡¹ç›®å°é¢ã€æ ‡é¢˜ã€çŠ¶æ€ã€å­—æ•°
- **ç­›é€‰åŠŸèƒ½**: æŒ‰çŠ¶æ€ã€ç±»å‹ç­›é€‰
- **æ’åºåŠŸèƒ½**: æŒ‰åˆ›å»ºæ—¶é—´ã€æ›´æ–°æ—¶é—´ã€å­—æ•°æ’åº
- **å¿«æ·æ“ä½œ**: ç»§ç»­åˆ›ä½œã€æŸ¥çœ‹å¤§çº²ã€åˆ é™¤

### é¡¹ç›®è¯¦æƒ…é¡µ

- **åŸºæœ¬ä¿¡æ¯ç¼–è¾‘**: åœ¨çº¿ä¿®æ”¹æ ‡é¢˜ã€ç®€ä»‹ã€ç±»å‹ã€é£æ ¼
- **çŠ¶æ€åˆ‡æ¢**: ä¸‹æ‹‰èœå•å¿«é€Ÿåˆ‡æ¢é¡¹ç›®çŠ¶æ€
- **æ¨¡å¼åˆ‡æ¢**: åˆ‡æ¢ç« èŠ‚æ¨¡å¼/å•ç¯‡æ¨¡å¼ï¼ˆä»…åœ¨æ— ç« èŠ‚æ—¶å¯åˆ‡æ¢ï¼‰
- **ç»Ÿè®¡é¢æ¿**: æ˜¾ç¤ºå­—æ•°ã€ç« èŠ‚æ•°ã€è§’è‰²æ•°

### åˆ›å»ºé¡¹ç›®æµç¨‹

```
1. ç‚¹å‡»"æ–°å»ºé¡¹ç›®"
       â†“
2. å¡«å†™åŸºæœ¬ä¿¡æ¯ï¼ˆæ ‡é¢˜å¿…å¡«ï¼‰
       â†“
3. é€‰æ‹©åˆ›ä½œæ¨¡å¼ï¼ˆç« èŠ‚/å•ç¯‡ï¼‰
       â†“
4. ç¡®è®¤åˆ›å»º
       â†“
5. è·³è½¬åˆ°é¡¹ç›®è¯¦æƒ…é¡µ
```

---

## âš™ï¸ æŠ€æœ¯å®ç°

### å‰ç«¯

**è·¯å¾„**: `src/features/novel_project/frontend/`

| æ–‡ä»¶ | è¯´æ˜ |
|------|------|
| `api.ts` | API è°ƒç”¨å°è£… |
| `pages/ProjectListPage.tsx` | é¡¹ç›®åˆ—è¡¨é¡µ |
| `pages/ProjectDetailPage.tsx` | é¡¹ç›®è¯¦æƒ…é¡µ |
| `pages/CreateProjectPage.tsx` | åˆ›å»ºé¡¹ç›®é¡µ |

### åç«¯

**è·¯å¾„**: `src/features/novel_project/backend/`

| æ–‡ä»¶ | è¯´æ˜ |
|------|------|
| `models.py` | æ•°æ®æ¨¡å‹å®šä¹‰ |
| `schemas.py` | Pydantic éªŒè¯æ¨¡å‹ |
| `router.py` | FastAPI è·¯ç”± |
| `services/` | ä¸šåŠ¡é€»è¾‘æœåŠ¡ |

---

## ğŸ”— å…³è”æ–‡æ¡£

- [å¤§çº²ç³»ç»Ÿ](./outline-system.md) - é¡¹ç›®å¤§çº²ç®¡ç†
- [ç« èŠ‚ç³»ç»Ÿ](./chapter-system.md) - é¡¹ç›®ç« èŠ‚ç®¡ç†
- [äººç‰©ç³»ç»Ÿ](./character-system.md) - é¡¹ç›®è§’è‰²ç®¡ç†
- [è¿”å›æ–‡æ¡£ä¸­å¿ƒ](./README.md)
